/* ============================================================
 * [1] 숫자/비숫자 검증
 * ============================================================ */
/* 숫자가 아닌 문자가 포함된 데이터 찾기 */
SELECT *
FROM USER_DATA
WHERE REGEXP_LIKE(ID, '[^0-9]');
-- [0-9]  : 숫자 범위
-- [^0-9] : 숫자가 아닌 문자

/* 숫자로만 구성된 데이터 찾기 */
SELECT *
FROM USER_DATA
WHERE REGEXP_LIKE(PHONE_NUMBER, '^[0-9]+$');
-- ^  : 문자열 시작
-- +  : 1회 이상 반복
-- $  : 문자열 끝

/* ============================================================
 * [2] 한국 전화번호 형식 검증
 * ============================================================ */
SELECT *
FROM 테이블명
WHERE REGEXP_LIKE(전화번호, '^0\d{1,2}-?\d{3,4}-?\d{4}$');
-- ^0\d{1,2}-?\d{3,4}-?\d{4}$
-- 0으로 시작, 지역번호 1~2자리, 하이픈 선택, 중간 3~4자리, 마지막 4자리
-- 예: 010-1234-5678, 02-123-4567, 0311234567

/* 국제 전화번호(국가코드 82) 포함 */
SELECT *
FROM 테이블명
WHERE REGEXP_LIKE(전화번호, '^\+?82-?0?\d{1,2}-?\d{3,4}-?\d{4}$');
-- ^\+?82-?0?\d{1,2}-?\d{3,4}-?\d{4}$
-- + 선택, 국가코드 82, 하이픈 선택, 0 선택, 나머지는 국내 형식 동일
-- 예: +82-10-1234-5678, +82-2-123-4567

/* ============================================================
 * [3] 허용 문자 외 포함 데이터 찾기
 * ============================================================ */
SELECT *
FROM 테이블명
WHERE NOT REGEXP_LIKE(전화번호컬럼, '^[0-9+\-()\s]+$');
-- 허용 문자: 숫자, +, -, (, ), 공백

/* ============================================================
 * [4] 문자열 처리 예제 (중복 제거/추출)
 * ============================================================ */
SELECT
    REGEXP_REPLACE(
        '10,10,10,10,20,30,40,50',
        '([^,]+)(,\1)*(,|$)',
        '\1\3'
    ) AS DEDUPLICATED_VALUES, -- 중복 값 제거: 10,20,30,40,50
    REGEXP_SUBSTR('10,10,10,10,20,30,40,50', '([^,]+)') AS FIRST_VALUE, -- 첫 값: 10
    REGEXP_SUBSTR('10,10,10,10,20,30,40,50', '([^,]+)(,\1)*') AS FIRST_REPEATED_SERIES, -- 반복 시리즈 시작: 10
    REGEXP_SUBSTR('10,10,10,10,20,30,40,50', '(,|$)') AS FIRST_COMMA_OR_END -- 첫 구분자: ,
FROM
    DUAL;

/* ============================================================
 * [5] 추가 예제
 * ============================================================ */
/* 이메일 형식 검증 */
SELECT *
FROM USER_DATA
WHERE REGEXP_LIKE(EMAIL, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$');

/* 공백 제거 후 숫자만인지 확인 */
SELECT *
FROM USER_DATA
WHERE REGEXP_LIKE(REPLACE(PHONE_NUMBER, ' ', ''), '^[0-9]+$');
